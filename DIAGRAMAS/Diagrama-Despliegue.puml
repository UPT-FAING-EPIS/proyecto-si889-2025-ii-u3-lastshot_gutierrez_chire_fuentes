@startuml
!theme plain
title "Diagrama de Despliegue - Sistema LastShot\n(Arquitectura de Infraestructura)"

' === DISPOSITIVO M√ìVIL ===
node "üì± Dispositivo M√≥vil" as DispositivoMovil #lightblue {
  
  artifact "üéÆ Flutter App" as FlutterApp #lightgreen
  
  note bottom of FlutterApp : "Caracter√≠sticas:\n‚Ä¢ Plataforma: Android 6.0+\n‚Ä¢ Framework: Flutter 3.0+\n‚Ä¢ Almacenamiento: 50MB\n‚Ä¢ Conectividad: WiFi/4G/5G\n‚Ä¢ Funciona offline (juegos solo device)"
}

' === SERVIDOR BACKEND (Azure) ===
node "‚òÅÔ∏è Servidor Backend (Azure App Service)" as ServidorBackend #lightyellow {
  
  artifact "üåê API (Node.js)" as NodeAPI #lightgreen
  
  note bottom of NodeAPI : "Caracter√≠sticas:\n‚Ä¢ Framework: Express.js\n‚Ä¢ WebSockets: Socket.IO\n‚Ä¢ Autenticaci√≥n: JWT + Firebase\n‚Ä¢ Rate Limiting: 1000 req/min\n‚Ä¢ Logs: Winston + Azure Monitor\n‚Ä¢ OS: Linux Container\n‚Ä¢ Runtime: Node.js 18.x\n‚Ä¢ CPU: 1 vCPU, RAM: 1.75 GB"
}

' === SERVICIOS EXTERNOS ===
node "ÔøΩ Servicios Firebase" as ServiciosFirebase #lightcoral {
  
  database "üíæ Base de Datos\n(Firestore)" as Firebase #lightsteelblue
  artifact "üîê Firebase Auth" as FirebaseAuth #lightpink
  
  note bottom of Firebase : "Caracter√≠sticas:\n‚Ä¢ Tipo: NoSQL (Firestore)\n‚Ä¢ Regi√≥n: us-central1\n‚Ä¢ Backup autom√°tico\n‚Ä¢ Escalado autom√°tico\n‚Ä¢ 99.95% uptime SLA"
  
  note bottom of FirebaseAuth : "Caracter√≠sticas:\n‚Ä¢ Autenticaci√≥n OAuth\n‚Ä¢ JWT Token Management\n‚Ä¢ Multi-factor Auth\n‚Ä¢ Social Login (Google)"
}

' === CONEXIONES Y COMUNICACI√ìN ===

' Flutter App hacia API Backend
FlutterApp --> NodeAPI : "Solicita datos\n(HTTPS/REST)\n(WSS/WebSocket)"

' API hacia Firebase Services
NodeAPI --> Firebase : "Consulta datos\n(Firebase Admin SDK)\n(Firestore API)"

NodeAPI --> FirebaseAuth : "Autenticaci√≥n\n(Firebase Admin SDK)\n(JWT Verification)"

' === PROTOCOLOS Y PUERTOS ===
note top of FlutterApp : "Protocolos:\n‚Ä¢ HTTPS: 443\n‚Ä¢ WSS: 443\n‚Ä¢ JSON over HTTP"

note top of ServiciosFirebase : "Protocolos:\n‚Ä¢ HTTPS: 443\n‚Ä¢ Firebase APIs\n‚Ä¢ OAuth 2.0"

note top of NodeAPI : "Protocolos:\n‚Ä¢ HTTP: 3000\n‚Ä¢ WebSocket: 3001\n‚Ä¢ Firebase: 443"

@enduml
