@startuml
!theme plain
title "Diagrama de Base de Datos No Relacional - Sistema LastShot\n(Firebase Firestore)"

' === COLECCIONES PRINCIPALES ===
package "Firebase Firestore Database" #lightcoral {
  
  json "üë• users" as users {
    "documentId": "user123",
    "fields": {
      "email": "juan.perez@gmail.com",
      "name": "Juan P√©rez",
      "avatar": "avatar_01.png",
      "createdAt": "2025-11-02T14:30:00Z",
      "lastLogin": "2025-11-02T15:45:00Z",
      "gamesPlayed": 15,
      "preferences": {
        "soundEnabled": true,
        "notifications": true
      }
    }
  }
  
  json "üéÆ gameRooms" as gameRooms {
    "documentId": "room_ABC123",
    "fields": {
      "code": "ABC123",
      "organizerId": "user123",
      "gameType": "VASTA",
      "status": "WAITING",
      "createdAt": "2025-11-02T14:35:00Z",
      "maxPlayers": 8,
      "players": [
        {"id": "user123", "name": "Juan", "ready": true},
        {"id": "user456", "name": "Mar√≠a", "ready": false}
      ],
      "configuration": {
        "timePerTurn": 5,
        "rounds": 10,
        "themes": ["CIUDADES", "ANIMALES"]
      }
    }
  }
  
  json "üìä gameHistory" as gameHistory {
    "documentId": "game_789",
    "fields": {
      "roomCode": "ABC123",
      "gameType": "VASTA",
      "startTime": "2025-11-02T14:40:00Z",
      "endTime": "2025-11-02T14:55:00Z",
      "winners": ["user123"],
      "participants": ["user123", "user456", "user789"],
      "rounds": [
        {
          "theme": "CIUDADES",
          "letter": "M",
          "answers": {
            "user123": "Madrid",
            "user456": "M√©xico",
            "user789": null
          }
        }
      ],
      "finalScores": {
        "user123": 85,
        "user456": 70,
        "user789": 45
      }
    }
  }
  
  json "üéØ gameTemplates" as gameTemplates {
    "documentId": "template_vasta",
    "fields": {
      "gameType": "VASTA",
      "name": "Juego VASTA",
      "description": "Encuentra palabras por categor√≠a",
      "minPlayers": 2,
      "maxPlayers": 8,
      "themes": [
        "CIUDADES", "ANIMALES", "COLORES", "COMIDAS",
        "PROFESIONES", "PA√çSES", "DEPORTES", "FRUTAS",
        "NOMBRES", "OBJETOS", "MARCAS", "PEL√çCULAS",
        "CANCIONES", "LIBROS", "VIDEOJUEGOS"
      ],
      "defaultConfig": {
        "timePerTurn": 5,
        "rounds": 10,
        "allowReconnect": true
      }
    }
  }
  
  json "üÉè cardDecks" as cardDecks {
    "documentId": "deck_yonunca",
    "fields": {
      "gameType": "YO_NUNCA",
      "totalCards": 100,
      "cards": [
        {
          "id": 1,
          "text": "Yo nunca he cantado en karaoke",
          "category": "entretenimiento",
          "difficulty": "easy"
        },
        {
          "id": 2,
          "text": "Yo nunca he perdido las llaves",
          "category": "vida_diaria",
          "difficulty": "medium"
        }
      ],
      "version": "1.0",
      "lastUpdated": "2025-11-02T10:00:00Z"
    }
  }
}

' === √çNDICES Y CONSULTAS ===
note top of users : "√çndices:\n- email (√∫nico)\n- lastLogin (desc)\n- gamesPlayed (desc)"
note top of gameRooms : "√çndices:\n- code (√∫nico)\n- status + createdAt\n- organizerId"
note top of gameHistory : "√çndices:\n- roomCode\n- startTime (desc)\n- participants (array)"

@enduml